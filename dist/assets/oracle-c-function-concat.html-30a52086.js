import{_ as a,W as e,X as p,Y as n,Z as t,$ as o,a0 as c,D as l}from"./framework-f64bc974.js";const i={},r=c(`<h1 id="oracle在1对多时把一列的值合并为一个值并用逗号分隔" tabindex="-1"><a class="header-anchor" href="#oracle在1对多时把一列的值合并为一个值并用逗号分隔" aria-hidden="true">#</a> Oracle在1对多时把一列的值合并为一个值并用逗号分隔</h1><p>Oracle把一列的值合并为一个值，并用逗号分隔。</p><p>实例中将把部门表（DEPT表）与员工表（EMP表）关联，查询每个部门下的所有员工姓名，员工姓名之间以逗号分隔（如图一）。</p><figure><img src="https://zszblog.oss-cn-beijing.aliyuncs.com/zszblog/blogimage-master/img/image-20201221152131891.png" alt="image-20201221152131891" tabindex="0" loading="lazy"><figcaption>image-20201221152131891</figcaption></figure><h2 id="_1-wmsys-wm-concat-列名-函数" tabindex="-1"><a class="header-anchor" href="#_1-wmsys-wm-concat-列名-函数" aria-hidden="true">#</a> 1. WMSYS.WM_CONCAT(列名)函数</h2><p>介绍：其函数在Oracle 10g推出，在10g版本中，返回字符串类型，在11g版本中返回clob类型。括号里面的参数是列，而且可以是多个列的集合，也就是说在括号里面可以自由地用‘||’合并字符串。</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">SELECT</span> D<span class="token punctuation">.</span>DEPTNO <span class="token keyword">AS</span> 部门编号<span class="token punctuation">,</span>D<span class="token punctuation">.</span>DNAME <span class="token keyword">AS</span> 部门名称<span class="token punctuation">,</span>WMSYS<span class="token punctuation">.</span>WM_CONCAT<span class="token punctuation">(</span>E<span class="token punctuation">.</span>ENAME<span class="token punctuation">)</span> <span class="token keyword">AS</span> 员工列表 
<span class="token keyword">FROM</span> DEPT D
<span class="token keyword">LEFT</span> <span class="token keyword">JOIN</span> EMP E <span class="token keyword">ON</span> D<span class="token punctuation">.</span>DEPTNO <span class="token operator">=</span> E<span class="token punctuation">.</span>DEPTNO
<span class="token keyword">GROUP</span> <span class="token keyword">BY</span> D<span class="token punctuation">.</span>DEPTNO<span class="token punctuation">,</span>D<span class="token punctuation">.</span>DNAME
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>拼接多列（拼接员工姓名和员工编号）</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">SELECT</span> D<span class="token punctuation">.</span>DEPTNO <span class="token keyword">AS</span> 部门编号<span class="token punctuation">,</span>D<span class="token punctuation">.</span>DNAME <span class="token keyword">AS</span> 部门名称<span class="token punctuation">,</span>WMSYS<span class="token punctuation">.</span>WM_CONCAT<span class="token punctuation">(</span>E<span class="token punctuation">.</span>ENAME<span class="token operator">||</span><span class="token string">&#39;(&#39;</span><span class="token operator">||</span>E<span class="token punctuation">.</span>EMPNO<span class="token operator">||</span><span class="token string">&#39;)&#39;</span><span class="token punctuation">)</span> <span class="token keyword">AS</span> 员工列表 
<span class="token keyword">FROM</span> DEPT D
<span class="token keyword">LEFT</span> <span class="token keyword">JOIN</span> EMP E <span class="token keyword">ON</span> D<span class="token punctuation">.</span>DEPTNO <span class="token operator">=</span> E<span class="token punctuation">.</span>DEPTNO
<span class="token keyword">GROUP</span> <span class="token keyword">BY</span> D<span class="token punctuation">.</span>DEPTNO<span class="token punctuation">,</span>D<span class="token punctuation">.</span>DNAME
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="_2-listagg-列名-分隔符-within-group-order-by-列名-函数" tabindex="-1"><a class="header-anchor" href="#_2-listagg-列名-分隔符-within-group-order-by-列名-函数" aria-hidden="true">#</a> 2. LISTAGG(列名,&lt;分隔符&gt;) WITHIN GROUP(ORDER BY 列名)函数</h2><p>介绍：其函数在Oracle 11g 版本中推出，对分组后的数据按照一定的排序进行字符串连接。</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">SELECT</span> D<span class="token punctuation">.</span>DEPTNO <span class="token keyword">AS</span> 部门编号<span class="token punctuation">,</span>D<span class="token punctuation">.</span>DNAME <span class="token keyword">AS</span> 部门名称<span class="token punctuation">,</span>LISTAGG<span class="token punctuation">(</span>E<span class="token punctuation">.</span>ENAME<span class="token punctuation">,</span><span class="token string">&#39;,&#39;</span><span class="token punctuation">)</span> <span class="token keyword">WITHIN</span> <span class="token keyword">GROUP</span><span class="token punctuation">(</span><span class="token keyword">ORDER</span> <span class="token keyword">BY</span> E<span class="token punctuation">.</span>ENAME<span class="token punctuation">)</span> <span class="token keyword">AS</span> 员工列表 
<span class="token keyword">FROM</span> DEPT D
<span class="token keyword">LEFT</span> <span class="token keyword">JOIN</span> EMP E <span class="token keyword">ON</span> D<span class="token punctuation">.</span>DEPTNO <span class="token operator">=</span> E<span class="token punctuation">.</span>DEPTNO
<span class="token keyword">GROUP</span> <span class="token keyword">BY</span> D<span class="token punctuation">.</span>DEPTNO<span class="token punctuation">,</span>D<span class="token punctuation">.</span>DNAME
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>LISTAGG 中的字段可以不写在GROUP BY</p><h2 id="参考文章" tabindex="-1"><a class="header-anchor" href="#参考文章" aria-hidden="true">#</a> 参考文章</h2>`,14),u={href:"https://blog.csdn.net/pan_junbiao/article/details/79948222",target:"_blank",rel:"noopener noreferrer"};function k(d,E){const s=l("ExternalLinkIcon");return e(),p("div",null,[r,n("p",null,[n("a",u,[t("Oracle把一列的值合并为一个值并用逗号分隔"),o(s)])])])}const D=a(i,[["render",k],["__file","oracle-c-function-concat.html.vue"]]);export{D as default};
